<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.2.475">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Yipeng Li">

<title>Class 7: Clustering and PCA</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1.6em;
  vertical-align: middle;
}
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>


<script src="Class07_files/libs/clipboard/clipboard.min.js"></script>
<script src="Class07_files/libs/quarto-html/quarto.js"></script>
<script src="Class07_files/libs/quarto-html/popper.min.js"></script>
<script src="Class07_files/libs/quarto-html/tippy.umd.min.js"></script>
<script src="Class07_files/libs/quarto-html/anchor.min.js"></script>
<link href="Class07_files/libs/quarto-html/tippy.css" rel="stylesheet">
<link href="Class07_files/libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="Class07_files/libs/bootstrap/bootstrap.min.js"></script>
<link href="Class07_files/libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="Class07_files/libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">


</head>

<body class="fullcontent">

<div id="quarto-content" class="page-columns page-rows-contents page-layout-article">

<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">Class 7: Clustering and PCA</h1>
</div>



<div class="quarto-title-meta">

    <div>
    <div class="quarto-title-meta-heading">Author</div>
    <div class="quarto-title-meta-contents">
             <p>Yipeng Li </p>
          </div>
  </div>
    
  
    
  </div>
  

</header>

<section id="clustering" class="level1">
<h1>Clustering</h1>
<p>First let’s make up some data to cluster so we can get a feel for these methods and how to work with them.</p>
<p>We can use the <code>rnorm()</code> function to get random numbers from a normal distribution around a given <code>mean</code>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(<span class="fu">rnorm</span>(<span class="dv">5000</span>, <span class="at">mean=</span><span class="dv">3</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="Class07_files/figure-html/unnamed-chunk-1-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>Let’s get 30 points with a mean of 3.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a>tmp <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fu">rnorm</span>(<span class="dv">30</span>, <span class="at">mean=</span><span class="dv">3</span>), <span class="fu">rnorm</span>(<span class="dv">30</span>, <span class="at">mean=</span><span class="sc">-</span><span class="dv">3</span>))</span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a>tmp</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> [1]  2.5762444  3.1845014  1.5547363  2.0826626  4.4145543  4.6714217
 [7]  1.5812364  2.3795499  2.3787306  2.0558521  3.3911485  4.4115512
[13]  3.5947036  3.8903954  3.2130516  3.3514307  3.8058178  2.5323686
[19]  2.7627268  2.1746914  2.1608181  3.1282277  4.3668601  3.0749949
[25]  4.8269040  4.0102969  2.7861877  5.0093427  1.9414958  4.7791444
[31] -3.2980218 -3.0239340 -3.0126593 -4.0972423 -2.1526059 -4.5021635
[37] -4.1253031 -3.6418526 -3.8536437 -3.2644781 -2.7616401 -0.6380385
[43] -3.4420794 -2.6300920 -1.7125800 -5.3682886 -4.7128133 -1.7212512
[49] -2.4360733 -2.9954627 -3.6511660 -3.3489114 -2.2956614 -2.6804510
[55] -4.0680567 -3.1507729 -3.6593169 -4.4051134 -4.5355126 -2.6618093</code></pre>
</div>
</div>
<p>put two of these together:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">cbind</span>(<span class="at">x=</span>tmp, <span class="at">y=</span><span class="fu">rev</span>(tmp))</span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a>x</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>               x          y
 [1,]  2.5762444 -2.6618093
 [2,]  3.1845014 -4.5355126
 [3,]  1.5547363 -4.4051134
 [4,]  2.0826626 -3.6593169
 [5,]  4.4145543 -3.1507729
 [6,]  4.6714217 -4.0680567
 [7,]  1.5812364 -2.6804510
 [8,]  2.3795499 -2.2956614
 [9,]  2.3787306 -3.3489114
[10,]  2.0558521 -3.6511660
[11,]  3.3911485 -2.9954627
[12,]  4.4115512 -2.4360733
[13,]  3.5947036 -1.7212512
[14,]  3.8903954 -4.7128133
[15,]  3.2130516 -5.3682886
[16,]  3.3514307 -1.7125800
[17,]  3.8058178 -2.6300920
[18,]  2.5323686 -3.4420794
[19,]  2.7627268 -0.6380385
[20,]  2.1746914 -2.7616401
[21,]  2.1608181 -3.2644781
[22,]  3.1282277 -3.8536437
[23,]  4.3668601 -3.6418526
[24,]  3.0749949 -4.1253031
[25,]  4.8269040 -4.5021635
[26,]  4.0102969 -2.1526059
[27,]  2.7861877 -4.0972423
[28,]  5.0093427 -3.0126593
[29,]  1.9414958 -3.0239340
[30,]  4.7791444 -3.2980218
[31,] -3.2980218  4.7791444
[32,] -3.0239340  1.9414958
[33,] -3.0126593  5.0093427
[34,] -4.0972423  2.7861877
[35,] -2.1526059  4.0102969
[36,] -4.5021635  4.8269040
[37,] -4.1253031  3.0749949
[38,] -3.6418526  4.3668601
[39,] -3.8536437  3.1282277
[40,] -3.2644781  2.1608181
[41,] -2.7616401  2.1746914
[42,] -0.6380385  2.7627268
[43,] -3.4420794  2.5323686
[44,] -2.6300920  3.8058178
[45,] -1.7125800  3.3514307
[46,] -5.3682886  3.2130516
[47,] -4.7128133  3.8903954
[48,] -1.7212512  3.5947036
[49,] -2.4360733  4.4115512
[50,] -2.9954627  3.3911485
[51,] -3.6511660  2.0558521
[52,] -3.3489114  2.3787306
[53,] -2.2956614  2.3795499
[54,] -2.6804510  1.5812364
[55,] -4.0680567  4.6714217
[56,] -3.1507729  4.4145543
[57,] -3.6593169  2.0826626
[58,] -4.4051134  1.5547363
[59,] -4.5355126  3.1845014
[60,] -2.6618093  2.5762444</code></pre>
</div>
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(x)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="Class07_files/figure-html/unnamed-chunk-3-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<section id="k-means-clustering." class="level2">
<h2 class="anchored" data-anchor-id="k-means-clustering.">k-means clustering.</h2>
<p>Very popular clusterring method that we can use with the <code>kmeans()</code> function in base R.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a>km <span class="ot">&lt;-</span> <span class="fu">kmeans</span>(x, <span class="at">centers=</span><span class="dv">2</span>)</span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a>km</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>K-means clustering with 2 clusters of sizes 30, 30

Cluster means:
          x         y
1  3.203055 -3.261567
2 -3.261567  3.203055

Clustering vector:
 [1] 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 2 2 2 2 2 2 2 2
[39] 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2

Within cluster sum of squares by cluster:
[1] 60.76724 60.76724
 (between_SS / total_SS =  91.2 %)

Available components:

[1] "cluster"      "centers"      "totss"        "withinss"     "tot.withinss"
[6] "betweenss"    "size"         "iter"         "ifault"      </code></pre>
</div>
</div>
<blockquote class="blockquote">
<p>Q. Cluster exercise</p>
</blockquote>
<p>-cluster size</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a>km<span class="sc">$</span>size</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 30 30</code></pre>
</div>
</div>
<p>-cluster assignment</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a>km<span class="sc">$</span>cluster</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> [1] 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 2 2 2 2 2 2 2 2
[39] 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2</code></pre>
</div>
</div>
<ul>
<li>cluster center</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a>km<span class="sc">$</span>centers</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>          x         y
1  3.203055 -3.261567
2 -3.261567  3.203055</code></pre>
</div>
</div>
<blockquote class="blockquote">
<p>Q. plot x colored by the means cluster assignment and add cluster centers as blue points</p>
</blockquote>
<div class="cell">
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(x, <span class="at">col=</span>km<span class="sc">$</span>cluster)</span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a><span class="fu">points</span>(km<span class="sc">$</span>centers, <span class="at">col=</span><span class="st">"blue"</span>, <span class="at">pch=</span><span class="dv">15</span>, <span class="at">cex=</span><span class="dv">3</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="Class07_files/figure-html/unnamed-chunk-8-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<blockquote class="blockquote">
<p>Q. let’s cluster into 3 groups for same <code>x</code> data and make a plot.</p>
</blockquote>
<div class="cell">
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a>km <span class="ot">&lt;-</span> <span class="fu">kmeans</span>(x, <span class="at">centers=</span><span class="dv">3</span>)</span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true" tabindex="-1"></a>km</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>K-means clustering with 3 clusters of sizes 13, 30, 17

Cluster means:
          x         y
1  4.107377 -2.766125
2 -3.261567  3.203055
3  2.511514 -3.640433

Clustering vector:
 [1] 3 3 3 3 1 1 3 3 3 3 1 1 1 3 3 1 1 3 1 3 3 3 1 3 1 1 3 1 3 1 2 2 2 2 2 2 2 2
[39] 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2

Within cluster sum of squares by cluster:
[1] 18.86492 60.76724 17.50988
 (between_SS / total_SS =  92.9 %)

Available components:

[1] "cluster"      "centers"      "totss"        "withinss"     "tot.withinss"
[6] "betweenss"    "size"         "iter"         "ifault"      </code></pre>
</div>
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(x, <span class="at">col=</span>km<span class="sc">$</span>cluster)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="Class07_files/figure-html/unnamed-chunk-9-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</section>
</section>
<section id="hierarchical-clustering" class="level1">
<h1>Hierarchical Clustering</h1>
<p>We can use the <code>hclust()</code> function for hierarchical Clustering. Unlike <code>kmeans()</code>, where we could just pass in our data as input, we need to give <code>hclust()</code> a “distance matrix”</p>
<p>We will use the <code>dist()</code> function to start with</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a>d <span class="ot">&lt;-</span> <span class="fu">dist</span>(x)</span>
<span id="cb19-2"><a href="#cb19-2" aria-hidden="true" tabindex="-1"></a>d</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>             1           2           3           4           5           6
2   1.96995964                                                            
3   2.02054152  1.63497345                                                
4   1.11294410  1.40775272  0.91373874                                    
5   1.90222731  1.85217013  3.12280784  2.38669980                        
6   2.52335088  1.55866834  3.13485803  2.62082847  0.95257039            
7   0.99518256  2.45187938  1.72486604  1.09982127  2.87208857  3.38743184
8   0.41563564  2.38010097  2.26497359  1.39559974  2.20736458  2.89725062
9   0.71492727  1.43432538  1.33960039  0.42896138  2.04544302  2.40283221
10  1.11787071  1.43384734  0.90529203  0.02802212  2.41119664  2.64858492
11  0.88056420  1.55385223  2.31506470  1.46725517  1.03512352  1.67019677
12  1.84913709  2.43172709  3.46965563  2.63059827  0.71470587  1.65254415
13  1.38632919  2.84399955  3.37113969  2.45812263  1.64793433  2.58201818
14  2.43590037  0.72781995  2.35584011  2.09230797  1.64763855  1.01277500
15  2.78038735  0.83326522  1.91773716  2.04899081  2.52209927  1.95382871
16  1.22554074  2.82786390  3.23695026  2.32369478  1.78847157  2.70011972
17  1.22998242  2.00416113  2.86671741  2.00712925  0.80104226  1.67839579
18  0.78150273  1.27313534  1.37229710  0.49942731  1.90459510  2.22876554
19  2.03234441  3.92022939  3.95602001  3.09687113  3.00705307  3.92532045
20  0.41377655  2.04116148  1.75651607  0.90238185  2.27341380  2.81786916
21  0.73197593  1.63200991  1.29165938  0.40249967  2.25660271  2.63607075
22  1.31345154  0.68418707  1.66733135  1.06347039  1.46583202  1.55801818
23  2.04127159  1.48209320  2.91386463  2.28426428  0.49339036  0.52383930
24  1.54614564  0.42457452  1.54579420  1.09629670  1.65654117  1.59745292
25  2.90729641  1.64274113  3.27360657  2.87075796  1.41290086  0.46111116
26  1.52177353  2.52194023  3.33220161  2.44662055  1.07692214  2.02633595
27  1.45070472  0.59222862  1.26935298  0.82868942  1.88344954  1.88545993
28  2.45826421  2.37678943  3.72467897  2.99726916  0.61061329  1.10817609
29  0.73078043  1.95702148  1.43430805  0.65087603  2.47630901  2.92278763
30  2.29293146  2.01848202  3.40917276  2.72057863  0.39320244  0.77753318
31  9.48023176 11.34838942 10.38748537 10.00796652 11.06198074 11.90735048
32  7.24930446  8.97197350  7.82583352  7.57934244  9.01456089  9.76387318
33  9.49117569 11.38020489 10.46389439 10.05524561 11.03408298 11.89303488
34  8.61487639 10.32623296  9.14656623  8.92948790 10.37777346 11.12969602
35  8.17795980 10.07549384  9.19584242  8.76130563  9.71640441 10.57483569
36 10.30459532 12.11361479 11.04156607 10.74131653 11.96458044 12.77791026
37  8.82165862 10.55239628  9.39227705  9.15913718 10.56831818 11.33161739
38  9.38439790 11.21834884 10.19568814  9.85847822 11.01909701 11.84307187
39  8.65262903 10.40521038  9.27371571  9.01723322 10.38214559 11.15630983
40  7.57441575  9.29678344  8.14470898  7.90353626  9.33705186 10.08847790
41  7.20310691  8.96568105  7.86923988  7.58306808  8.93634912  9.70681773
42  6.30533158  8.23869594  7.49574514  6.97458677  7.77805715  8.65158775
43  7.94982417  9.68847346  8.54966804  8.29817711  9.69663805 10.45918318
44  8.30277897 10.16795409  9.21586565  8.82826669  9.90056543 10.73824946
45  7.38600500  9.28360287  8.41661055  7.97210445  8.93422782  9.78796561
46  9.88076891 11.54081732 10.29391626 10.13637621 11.67057312 12.40202886
47  9.80110957 11.54831188 10.39700177 10.15759075 11.52765766 12.30450432
48  7.59028465  9.49562133  8.64460329  8.19088357  9.11863815  9.97918638
49  8.66924207 10.56602163  9.67781678  9.24975069 10.20391325 11.06436785
50  8.22692030 10.05106529  9.02696023  8.68886756  9.88458839 10.69676858
51  7.81261604  9.49591696  8.29731854  8.09567465  9.60024939 10.33284690
52  7.77910743  9.51274101  8.37056149  8.12157702  9.53135916 10.29013157
53  7.01076090  8.82328028  7.80110373  7.45906389  8.69548533  9.49272761
54  6.75546318  8.47421299  7.33302093  7.08171240  8.52824788  9.27170664
55  9.89560573 11.72037707 10.67704503 10.35531524 11.53869216 12.35948882
56  9.10349648 10.96537272  9.99641714  9.62165494 10.69898832 11.53869216
57  7.83531993  9.52040405  8.32331599  8.12038534  9.62165494 10.35531524
58  8.15589441  9.73105267  8.42850035  8.32331599  9.99641714 10.67704503
59  9.20632591 10.91774860  9.73105267  9.52040405 10.96537272 11.72037707
60  7.40772652  9.20632591  8.15589441  7.83531993  9.10349648  9.89560573
             7           8           9          10          11          12
2                                                                         
3                                                                         
4                                                                         
5                                                                         
6                                                                         
7                                                                         
8   0.88620961                                                            
9   1.04059414  1.05325031                                                
10  1.08053126  1.39361873  0.44227635                                    
11  1.83712111  1.23006241  1.07234136  1.48760318                        
12  2.84084535  2.03684678  2.22837008  2.65061666  1.16367448            
13  2.23027220  1.34407790  2.03171555  2.46832639  1.29036807  1.08545422
14  3.07615215  2.85048727  2.03601554  2.11958585  1.78844642  2.33562590
15  3.14440644  3.18367132  2.18494302  2.07065702  2.37950020  3.16769441
16  2.01751383  1.13337381  1.90360869  2.33166032  1.28349742  1.28347113
17  2.22515128  1.46495183  1.59789839  2.02607307  0.55267206  0.63604736
18  1.21849504  1.15655858  0.17968005  0.52037023  0.96797177  2.13151956
19  2.35952710  1.70133421  2.73793440  3.09493285  2.43974645  2.43958014
20  0.59898281  0.50902183  0.62170695  0.89742918  1.23872554  2.26042826
21  0.82280168  0.99320165  0.23369814  0.40068117  1.25939754  2.39834406
22  1.94153630  1.72853331  0.90360430  1.09132333  0.89755333  1.91217812
23  2.94686145  2.40034011  2.00959542  2.31102677  1.17039870  1.20660724
24  2.07819923  1.95735347  1.04286537  1.12403645  1.17324016  2.15403814
25  3.72196111  3.29517732  2.70620468  2.89877997  2.08123549  2.10742650
26  2.48575042  1.63700963  2.02315483  2.46283106  1.04582616  0.49128281
27  1.85989386  1.84690229  0.85206836  0.85578857  1.25693906  2.32406735
28  3.44416530  2.72578351  2.65201538  3.02172093  1.61828556  0.83054554
29  0.49776238  0.84986609  0.54477934  0.63757152  1.44993222  2.53904587
30  3.25699383  2.60053452  2.40095319  2.74609387  1.42058951  0.93705915
31  8.91362571  9.07125665  9.91417204  9.98669611 10.25619396 10.55920845
32  6.52456790  6.86666872  7.56156015  7.55526922  8.09486518  8.62841538
33  8.95749985  9.07959273  9.94623017 10.03465089 10.25112984 10.51442444
34  7.88221153  8.23249825  8.92063140  8.90505999  9.46062777  9.98356538
35  7.66209410  7.76566462  8.64239301  8.74123182  8.93386150  9.20020920
36  9.66271874  9.90398493 10.68600299 10.71845326 11.11277622 11.49804986
37  8.10492137  8.43546454  9.14160956  9.13498333  9.66165101 10.16118869
38  8.77184433  8.98033862  9.78675388  9.83628907 10.18169448 10.54216382
39  7.95478913  8.26264340  8.98864948  8.99345986  9.48612663  9.96367874
40  6.84973251  7.19133241  7.88688295  7.87940816  8.41929909  8.94722513
41  6.51406045  6.81292071  7.54543554  7.55968554  8.03662246  8.52724019
42  5.87821109  5.89008754  6.81564501  6.95665640  7.02787981  7.24747403
43  7.23928099  7.56315021  8.27473757  8.27425832  8.78919346  9.29327332
44  7.73349660  7.89459060  8.73375366  8.80708125  9.08365311  9.40988549
45  6.87261402  6.97389251  7.85069463  7.95219731  8.14439076  8.42616086
46  9.11203985  9.50657248 10.15261854 10.11114971 10.73654450 11.29415246
47  9.09896064  9.41110597 10.13398033 10.13360652 10.63434246 11.10307327
48  7.09112042  7.17725359  8.06372362  8.17123831  8.34067876  8.60125199
49  8.15078359  8.25693217  9.13274967  9.22956143  9.42445596  9.68400357
50  7.60332131  7.82499633  8.62034570  8.66660113  9.03203218  9.42445596
51  7.05766267  7.43674692  8.09759971  8.07094245  8.66660113  9.22956143
52  7.06411176  7.39359242  8.10010888  8.09759971  8.62034570  9.13274967
53  6.37447612  6.61174725  7.39359242  7.43674692  7.82499633  8.25693217
54  6.02693612  6.37447612  7.06411176  7.05766267  7.60332131  8.15078359
55  9.27170664  9.49272761 10.29013157 10.33284690 10.69676858 11.06436785
56  8.52824788  8.69548533  9.53135916  9.60024939  9.88458839 10.20391325
57  7.08171240  7.45906389  8.12157702  8.09567465  8.68886756  9.24975069
58  7.33302093  7.80110373  8.37056149  8.29731854  9.02696023  9.67781678
59  8.47421299  8.82328028  9.51274101  9.49591696 10.05106529 10.56602163
60  6.75546318  7.01076090  7.77910743  7.81261604  8.22692030  8.66924207
            13          14          15          16          17          18
2                                                                         
3                                                                         
4                                                                         
5                                                                         
6                                                                         
7                                                                         
8                                                                         
9                                                                         
10                                                                        
11                                                                        
12                                                                        
13                                                                        
14  3.00614001                                                            
15  3.66695246  0.94257232                                                
16  0.24342732  3.04825902  3.65832672                                    
17  0.93303852  2.08443792  2.80162318  1.02386324                        
18  2.02232671  1.85983917  2.04294184  1.91364337  1.51029679            
19  1.36584589  4.22793405  4.75163745  1.22523944  2.24862535  2.81348718
20  1.76035332  2.59821428  2.80585252  1.57646526  1.63642244  0.76872010
21  2.10655572  2.25590618  2.35227845  1.95600264  1.76308531  0.41181546
22  2.18281876  1.14850862  1.51701820  2.15266662  1.39864476  0.72417768
23  2.07000863  1.17216695  2.07650074  2.18018114  1.15690452  1.84533698
24  2.45958594  1.00501061  1.25062886  2.42850774  1.66425914  0.87248954
25  3.04167573  0.95990711  1.83158196  3.15575626  2.13243257  2.52758209
26  0.59898645  2.56301350  3.31303715  0.79229255  0.51942724  1.96138061
27  2.50978720  1.26420033  1.34081002  2.45073746  1.78666605  0.70261127
28  1.91544736  2.03532965  2.96237260  2.10686451  1.26286571  2.51392169
29  2.10477512  2.57886084  2.66699321  1.92550402  1.90546791  0.72386201
30  1.97208154  1.67078117  2.59589124  2.13353977  1.18046380  2.25138935
31  9.47442902 11.90674612 12.05671897  9.29288460 10.26456627 10.07878820
32  7.56452763  9.59623786  9.60900289  7.34830218  8.21857191  7.73662585
33  9.43176214 11.92361024 12.10184722  9.25666709 10.23975545 10.10810903
34  8.91532592 10.95615683 10.95152408  8.70181823  9.58094174  9.09632072
35  8.11678571 10.61181031 10.80500564  7.94013475  8.92174752  8.80266429
36 10.41333725 12.70595342 12.78540167 10.21977462 11.16375129 10.85636807
37  9.08859063 11.17592859 11.18662082  8.87819928  9.76988718  9.31648266
38  9.45689405 11.79725523 11.90641979  9.26636954 10.21886169  9.95492559
39  8.88793130 11.02052933 11.05119774  8.68023716  9.58256734  9.16242806
40  7.88155030  9.92164423  9.93206113  7.66638524  8.54060325  8.06200294
41  7.45529833  9.57534843  9.62255097  7.24434356  8.13741031  7.71846107
42  6.16621150  8.74016101  8.99690539  5.99535119  6.98787191  6.96786201
43  8.22250541 10.30814472 10.33010898  8.01070333  8.89848373  8.44914531
44  8.32445624 10.72771331 10.87688169  8.13826324  9.10175095  8.89848373
45  7.34161839  9.81964184 10.01475669  7.16159265  8.13826324  8.01070333
46 10.23145016 12.18780392 12.13584764 10.01475669 10.87688169 10.33010898
47 10.02523889 12.16677450 12.18780392  9.81964184 10.72771331 10.30814472
48  7.51789531 10.02523889 10.23145016  7.34161839  8.32445624  8.22250541
49  8.60125199 11.10307327 11.29415246  8.42616086  9.40988549  9.29327332
50  8.34067876 10.63434246 10.73654450  8.14439076  9.08365311  8.78919346
51  8.17123831 10.13360652 10.11114971  7.95219731  8.80708125  8.27425832
52  8.06372362 10.13398033 10.15261854  7.85069463  8.73375366  8.27473757
53  7.17725359  9.41110597  9.50657248  6.97389251  7.89459060  7.56315021
54  7.09112042  9.09896064  9.11203985  6.87261402  7.73349660  7.23928099
55  9.97918638 12.30450432 12.40202886  9.78796561 10.73824946 10.45918318
56  9.11863815 11.52765766 11.67057312  8.93422782  9.90056543  9.69663805
57  8.19088357 10.15759075 10.13637621  7.97210445  8.82826669  8.29817711
58  8.64460329 10.39700177 10.29391626  8.41661055  9.21586565  8.54966804
59  9.49562133 11.54831188 11.54081732  9.28360287 10.16795409  9.68847346
60  7.59028465  9.80110957  9.88076891  7.38600500  8.30277897  7.94982417
            19          20          21          22          23          24
2                                                                         
3                                                                         
4                                                                         
5                                                                         
6                                                                         
7                                                                         
8                                                                         
9                                                                         
10                                                                        
11                                                                        
12                                                                        
13                                                                        
14                                                                        
15                                                                        
16                                                                        
17                                                                        
18                                                                        
19                                                                        
20  2.20351298                                                            
21  2.69452764  0.50302936                                                
22  3.23631084  1.44972531  1.13269479                                    
23  3.40531100  2.36228237  2.23808690  1.25660882                        
24  3.50121779  1.63405118  1.25568264  0.27682588  1.37936225            
25  4.38090053  3.17232622  2.93936716  1.81826267  0.97558964  1.79198477
26  1.96222977  1.93400372  2.15796935  1.91613561  1.53133702  2.18319128
27  3.45928335  1.46893191  1.04143330  0.41991861  1.64496355  0.29016719
28  3.26896107  2.84574396  2.85963373  2.06054566  0.89925978  2.23151918
29  2.52327515  0.35096755  0.32552074  1.44801618  2.50284148  1.58045378
30  3.33788119  2.65911278  2.61854114  1.74190745  0.53684072  1.89433892
31  8.12887102  9.31740413  9.72104909 10.76204966 11.38699282 10.95009254
32  6.33556945  7.01036323  7.34736811  8.45178888  9.26270031  8.60249860
33  8.07762332  9.34327456  9.75812370 10.78253312 11.37103718 10.97730780
34  7.66710514  8.37350254  8.70481913  9.81299025 10.62829864  9.96040617
35  6.76516951  8.03645649  8.45742151  9.47252693 10.05280213  9.67035669
36  9.09088709 10.10773924 10.48168823 11.55745555 12.26292865 11.72839893
37  7.82506061  8.58814522  8.92772298 10.03093925 10.82741322 10.18275908
38  8.12820081  9.20041844  9.58688222 10.64944464 11.32603020 10.82741322
39  7.61322011  8.42801083  8.77726828  9.87385725 10.64944464 10.03093925
40  6.64535910  7.33588162  7.67252746  8.77726828  9.58688222  8.92772298
41  6.19919988  6.98102689  7.33588162  8.42801083  9.20041844  8.58814522
42  4.80940845  6.19919988  6.64535910  7.61322011  8.12820081  7.82506061
43  6.96786201  7.71846107  8.06200294  9.16242806  9.95492559  9.31648266
44  6.98787191  8.13741031  8.54060325  9.58256734 10.21886169  9.76988718
45  5.99535119  7.24434356  7.66638524  8.68023716  9.26636954  8.87819928
46  8.99690539  9.62255097  9.93206113 11.05119774 11.90641979 11.18662082
47  8.74016101  9.57534843  9.92164423 11.02052933 11.79725523 11.17592859
48  6.16621150  7.45529833  7.88155030  8.88793130  9.45689405  9.08859063
49  7.24747403  8.52724019  8.94722513  9.96367874 10.54216382 10.16118869
50  7.02787981  8.03662246  8.41929909  9.48612663 10.18169448  9.66165101
51  6.95665640  7.55968554  7.87940816  8.99345986  9.83628907  9.13498333
52  6.81564501  7.54543554  7.88688295  8.98864948  9.78675388  9.14160956
53  5.89008754  6.81292071  7.19133241  8.26264340  8.98033862  8.43546454
54  5.87821109  6.51406045  6.84973251  7.95478913  8.77184433  8.10492137
55  8.65158775  9.70681773 10.08847790 11.15630983 11.84307187 11.33161739
56  7.77805715  8.93634912  9.33705186 10.38214559 11.01909701 10.56831818
57  6.97458677  7.58306808  7.90353626  9.01723322  9.85847822  9.15913718
58  7.49574514  7.86923988  8.14470898  9.27371571 10.19568814  9.39227705
59  8.23869594  8.96568105  9.29678344 10.40521038 11.21834884 10.55239628
60  6.30533158  7.20310691  7.57441575  8.65262903  9.38439790  8.82165862
            25          26          27          28          29          30
2                                                                         
3                                                                         
4                                                                         
5                                                                         
6                                                                         
7                                                                         
8                                                                         
9                                                                         
10                                                                        
11                                                                        
12                                                                        
13                                                                        
14                                                                        
15                                                                        
16                                                                        
17                                                                        
18                                                                        
19                                                                        
20                                                                        
21                                                                        
22                                                                        
23                                                                        
24                                                                        
25                                                                        
26  2.48742192                                                            
27  2.08050099  2.29783681                                                
28  1.50063545  1.31825040  2.47360840                                    
29  3.24202761  2.24480523  1.36583130  3.06786757                        
30  1.20508846  1.37953031  2.14723771  0.36663748  2.85085486            
31 12.33519741 10.07276947 10.76140535 11.38966672  9.39896675 11.42283794
32 10.15659402  8.13892334  8.37996845  9.43807108  7.02217812  9.39896675
33 12.32588746 10.03072387 10.79613428 11.34482392  9.43807108 11.38966672
34 11.52217211  9.49335950  9.73464002 10.79613428  8.37996845 10.76140535
35 11.00797627  8.71566082  9.49335950 10.03072387  8.13892334 10.07276947
36 13.19329379 11.00797627 11.52217211 12.32588746 10.15659402 12.33519741
37 11.72839893  9.67035669  9.96040617 10.97730780  8.60249860 10.95009254
38 12.26292865 10.05280213 10.62829864 11.37103718  9.26270031 11.38699282
39 11.55745555  9.47252693  9.81299025 10.78253312  8.45178888 10.76204966
40 10.48168823  8.45742151  8.70481913  9.75812370  7.34736811  9.72104909
41 10.10773924  8.03645649  8.37350254  9.34327456  7.01036323  9.31740413
42  9.09088709  6.76516951  7.66710514  8.07762332  6.33556945  8.12887102
43 10.85636807  8.80266429  9.09632072 10.10810903  7.73662585 10.07878820
44 11.16375129  8.92174752  9.58094174 10.23975545  8.21857191 10.26456627
45 10.21977462  7.94013475  8.70181823  9.25666709  7.34830218  9.29288460
46 12.78540167 10.80500564 10.95152408 12.10184722  9.60900289 12.05671897
47 12.70595342 10.61181031 10.95615683 11.92361024  9.59623786 11.90674612
48 10.41333725  8.11678571  8.91532592  9.43176214  7.56452763  9.47442902
49 11.49804986  9.20020920  9.98356538 10.51442444  8.62841538 10.55920845
50 11.11277622  8.93386150  9.46062777 10.25112984  8.09486518 10.25619396
51 10.71845326  8.74123182  8.90505999 10.03465089  7.55526922  9.98669611
52 10.68600299  8.64239301  8.92063140  9.94623017  7.56156015  9.91417204
53  9.90398493  7.76566462  8.23249825  9.07959273  6.86666872  9.07125665
54  9.66271874  7.66209410  7.88221153  8.95749985  6.52456790  8.91362571
55 12.77791026 10.57483569 11.12969602 11.89303488  9.76387318 11.90735048
56 11.96458044  9.71640441 10.37777346 11.03408298  9.01456089 11.06198074
57 10.74131653  8.76130563  8.92948790 10.05524561  7.57934244 10.00796652
58 11.04156607  9.19584242  9.14656623 10.46389439  7.82583352 10.38748537
59 12.11361479 10.07549384 10.32623296 11.38020489  8.97197350 11.34838942
60 10.30459532  8.17795980  8.61487639  9.49117569  7.24930446  9.48023176
            31          32          33          34          35          36
2                                                                         
3                                                                         
4                                                                         
5                                                                         
6                                                                         
7                                                                         
8                                                                         
9                                                                         
10                                                                        
11                                                                        
12                                                                        
13                                                                        
14                                                                        
15                                                                        
16                                                                        
17                                                                        
18                                                                        
19                                                                        
20                                                                        
21                                                                        
22                                                                        
23                                                                        
24                                                                        
25                                                                        
26                                                                        
27                                                                        
28                                                                        
29                                                                        
30                                                                        
31                                                                        
32  2.85085486                                                            
33  0.36663748  3.06786757                                                
34  2.14723771  1.36583130  2.47360840                                    
35  1.37953031  2.24480523  1.31825040  2.29783681                        
36  1.20508846  3.24202761  1.50063545  2.08050099  2.48742192            
37  1.89433892  1.58045378  2.23151918  0.29016719  2.18319128  1.79198477
38  0.53684072  2.50284148  0.89925978  1.64496355  1.53133702  0.97558964
39  1.74190745  1.44801618  2.06054566  0.41991861  1.91613561  1.81826267
40  2.61854114  0.32552074  2.85963373  1.04143330  2.15796935  2.93936716
41  2.65911278  0.35096755  2.84574396  1.46893191  1.93400372  3.17232622
42  3.33788119  2.52327515  3.26896107  3.45928335  1.96222977  4.38090053
43  2.25138935  0.72386201  2.51392169  0.70261127  1.96138061  2.52758209
44  1.18046380  1.90546791  1.26286571  1.78666605  0.51942724  2.13243257
45  2.13353977  1.92550402  2.10686451  2.45073746  0.79229255  3.15575626
46  2.59589124  2.66699321  2.96237260  1.34081002  3.31303715  1.83158196
47  1.67078117  2.57886084  2.03532965  1.26420033  2.56301350  0.95990711
48  1.97208154  2.10477512  1.91544736  2.50978720  0.59898645  3.04167573
49  0.93705915  2.53904587  0.83054554  2.32406735  0.49128281  2.10742650
50  1.42058951  1.44993222  1.61828556  1.25693906  1.04582616  2.08123549
51  2.74609387  0.63757152  3.02172093  0.85578857  2.46283106  2.89877997
52  2.40095319  0.54477934  2.65201538  0.85206836  2.02315483  2.70620468
53  2.60053452  0.84986609  2.72578351  1.84690229  1.63700963  3.29517732
54  3.25699383  0.49776238  3.44416530  1.85989386  2.48575042  3.72196111
55  0.77753318  2.92278763  1.10817609  1.88545993  2.02633595  0.46111116
56  0.39320244  2.47630901  0.61061329  1.88344954  1.07692214  1.41290086
57  2.72057863  0.65087603  2.99726916  0.82868942  2.44662055  2.87075796
58  3.40917276  1.43430805  3.72467897  1.26935298  3.33220161  3.27360657
59  2.01848202  1.95702148  2.37678943  0.59222862  2.52194023  1.64274113
60  2.29293146  0.73078043  2.45826421  1.45070472  1.52177353  2.90729641
            37          38          39          40          41          42
2                                                                         
3                                                                         
4                                                                         
5                                                                         
6                                                                         
7                                                                         
8                                                                         
9                                                                         
10                                                                        
11                                                                        
12                                                                        
13                                                                        
14                                                                        
15                                                                        
16                                                                        
17                                                                        
18                                                                        
19                                                                        
20                                                                        
21                                                                        
22                                                                        
23                                                                        
24                                                                        
25                                                                        
26                                                                        
27                                                                        
28                                                                        
29                                                                        
30                                                                        
31                                                                        
32                                                                        
33                                                                        
34                                                                        
35                                                                        
36                                                                        
37                                                                        
38  1.37936225                                                            
39  0.27682588  1.25660882                                                
40  1.25568264  2.23808690  1.13269479                                    
41  1.63405118  2.36228237  1.44972531  0.50302936                        
42  3.50121779  3.40531100  3.23631084  2.69452764  2.20351298            
43  0.87248954  1.84533698  0.72417768  0.41181546  0.76872010  2.81348718
44  1.66425914  1.15690452  1.39864476  1.76308531  1.63642244  2.24862535
45  2.42850774  2.18018114  2.15266662  1.95600264  1.57646526  1.22523944
46  1.25062886  2.07650074  1.51701820  2.35227845  2.80585252  4.75163745
47  1.00501061  1.17216695  1.14850862  2.25590618  2.59821428  4.22793405
48  2.45958594  2.07000863  2.18281876  2.10655572  1.76035332  1.36584589
49  2.15403814  1.20660724  1.91217812  2.39834406  2.26042826  2.43958014
50  1.17324016  1.17039870  0.89755333  1.25939754  1.23872554  2.43974645
51  1.12403645  2.31102677  1.09132333  0.40068117  0.89742918  3.09493285
52  1.04286537  2.00959542  0.90360430  0.23369814  0.62170695  2.73793440
53  1.95735347  2.40034011  1.72853331  0.99320165  0.50902183  1.70133421
54  2.07819923  2.94686145  1.94153630  0.82280168  0.59898281  2.35952710
55  1.59745292  0.52383930  1.55801818  2.63607075  2.81786916  3.92532045
56  1.65654117  0.49339036  1.46583202  2.25660271  2.27341380  3.00705307
57  1.09629670  2.28426428  1.06347039  0.40249967  0.90238185  3.09687113
58  1.54579420  2.91386463  1.66733135  1.29165938  1.75651607  3.95602001
59  0.42457452  1.48209320  0.68418707  1.63200991  2.04116148  3.92022939
60  1.54614564  2.04127159  1.31345154  0.73197593  0.41377655  2.03234441
            43          44          45          46          47          48
2                                                                         
3                                                                         
4                                                                         
5                                                                         
6                                                                         
7                                                                         
8                                                                         
9                                                                         
10                                                                        
11                                                                        
12                                                                        
13                                                                        
14                                                                        
15                                                                        
16                                                                        
17                                                                        
18                                                                        
19                                                                        
20                                                                        
21                                                                        
22                                                                        
23                                                                        
24                                                                        
25                                                                        
26                                                                        
27                                                                        
28                                                                        
29                                                                        
30                                                                        
31                                                                        
32                                                                        
33                                                                        
34                                                                        
35                                                                        
36                                                                        
37                                                                        
38                                                                        
39                                                                        
40                                                                        
41                                                                        
42                                                                        
43                                                                        
44  1.51029679                                                            
45  1.91364337  1.02386324                                                
46  2.04294184  2.80162318  3.65832672                                    
47  1.85983917  2.08443792  3.04825902  0.94257232                        
48  2.02232671  0.93303852  0.24342732  3.66695246  3.00614001            
49  2.13151956  0.63604736  1.28347113  3.16769441  2.33562590  1.08545422
50  0.96797177  0.55267206  1.28349742  2.37950020  1.78844642  1.29036807
51  0.52037023  2.02607307  2.33166032  2.07065702  2.11958585  2.46832639
52  0.17968005  1.59789839  1.90360869  2.18494302  2.03601554  2.03171555
53  1.15655858  1.46495183  1.13337381  3.18367132  2.85048727  1.34407790
54  1.21849504  2.22515128  2.01751383  3.14440644  3.07615215  2.23027220
55  2.22876554  1.67839579  2.70011972  1.95382871  1.01277500  2.58201818
56  1.90459510  0.80104226  1.78847157  2.52209927  1.64763855  1.64793433
57  0.49942731  2.00712925  2.32369478  2.04899081  2.09230797  2.45812263
58  1.37229710  2.86671741  3.23695026  1.91773716  2.35584011  3.37113969
59  1.27313534  2.00416113  2.82786390  0.83326522  0.72781995  2.84399955
60  0.78150273  1.22998242  1.22554074  2.78038735  2.43590037  1.38632919
            49          50          51          52          53          54
2                                                                         
3                                                                         
4                                                                         
5                                                                         
6                                                                         
7                                                                         
8                                                                         
9                                                                         
10                                                                        
11                                                                        
12                                                                        
13                                                                        
14                                                                        
15                                                                        
16                                                                        
17                                                                        
18                                                                        
19                                                                        
20                                                                        
21                                                                        
22                                                                        
23                                                                        
24                                                                        
25                                                                        
26                                                                        
27                                                                        
28                                                                        
29                                                                        
30                                                                        
31                                                                        
32                                                                        
33                                                                        
34                                                                        
35                                                                        
36                                                                        
37                                                                        
38                                                                        
39                                                                        
40                                                                        
41                                                                        
42                                                                        
43                                                                        
44                                                                        
45                                                                        
46                                                                        
47                                                                        
48                                                                        
49                                                                        
50  1.16367448                                                            
51  2.65061666  1.48760318                                                
52  2.22837008  1.07234136  0.44227635                                    
53  2.03684678  1.23006241  1.39361873  1.05325031                        
54  2.84084535  1.83712111  1.08053126  1.04059414  0.88620961            
55  1.65254415  1.67019677  2.64858492  2.40283221  2.89725062  3.38743184
56  0.71470587  1.03512352  2.41119664  2.04544302  2.20736458  2.87208857
57  2.63059827  1.46725517  0.02802212  0.42896138  1.39559974  1.09982127
58  3.46965563  2.31506470  0.90529203  1.33960039  2.26497359  1.72486604
59  2.43172709  1.55385223  1.43384734  1.43432538  2.38010097  2.45187938
60  1.84913709  0.88056420  1.11787071  0.71492727  0.41563564  0.99518256
            55          56          57          58          59
2                                                             
3                                                             
4                                                             
5                                                             
6                                                             
7                                                             
8                                                             
9                                                             
10                                                            
11                                                            
12                                                            
13                                                            
14                                                            
15                                                            
16                                                            
17                                                            
18                                                            
19                                                            
20                                                            
21                                                            
22                                                            
23                                                            
24                                                            
25                                                            
26                                                            
27                                                            
28                                                            
29                                                            
30                                                            
31                                                            
32                                                            
33                                                            
34                                                            
35                                                            
36                                                            
37                                                            
38                                                            
39                                                            
40                                                            
41                                                            
42                                                            
43                                                            
44                                                            
45                                                            
46                                                            
47                                                            
48                                                            
49                                                            
50                                                            
51                                                            
52                                                            
53                                                            
54                                                            
55                                                            
56  0.95257039                                                
57  2.62082847  2.38669980                                    
58  3.13485803  3.12280784  0.91373874                        
59  1.55866834  1.85217013  1.40775272  1.63497345            
60  2.52335088  1.90222731  1.11294410  2.02054152  1.96995964</code></pre>
</div>
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a>hc <span class="ot">&lt;-</span> <span class="fu">hclust</span>(d)</span>
<span id="cb21-2"><a href="#cb21-2" aria-hidden="true" tabindex="-1"></a>hc</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
hclust(d = d)

Cluster method   : complete 
Distance         : euclidean 
Number of objects: 60 </code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb23"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(hc)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="Class07_files/figure-html/unnamed-chunk-11-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>I can now “cut” my tree with the <code>cutres()</code> to yield a cluster membership vector</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb24"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a>grps <span class="ot">&lt;-</span> <span class="fu">cutree</span>(hc, <span class="at">h=</span><span class="dv">8</span>)</span>
<span id="cb24-2"><a href="#cb24-2" aria-hidden="true" tabindex="-1"></a>grps</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> [1] 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 2 2 2 2 2 2 2 2
[39] 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2</code></pre>
</div>
</div>
<p>You can also tell <code>cutree()</code> to cut where it yields “k” groups.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb26"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cutree</span>(hc, <span class="at">k=</span><span class="dv">2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> [1] 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 2 2 2 2 2 2 2 2
[39] 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb28"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(x, <span class="at">col=</span>grps)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="Class07_files/figure-html/unnamed-chunk-14-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</section>
<section id="principal-component-analysis-pca" class="level1">
<h1>Principal Component Analysis (PCA)</h1>
<ol type="1">
<li>PCA of UK food data Suppose that we are examining the following data, from the UK’s ‘Department for Environment, Food and Rural Affairs’ (DEFRA), showing the consumption in grams (per person, per week) of 17 different types of food-stuff measured and averaged in the four countries of the United Kingdom in 1997.</li>
</ol>
<div class="cell">
<div class="sourceCode cell-code" id="cb29"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a>url <span class="ot">&lt;-</span> <span class="st">"https://tinyurl.com/UK-foods"</span></span>
<span id="cb29-2"><a href="#cb29-2" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(url)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<blockquote class="blockquote">
<p>Q1. How many rows and columns are in your new data frame named x? What R functions could you use to answer this questions?</p>
</blockquote>
<div class="cell">
<div class="sourceCode cell-code" id="cb30"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a><span class="co">#rows</span></span>
<span id="cb30-2"><a href="#cb30-2" aria-hidden="true" tabindex="-1"></a><span class="fu">nrow</span>(x)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 17</code></pre>
</div>
<div class="sourceCode cell-code" id="cb32"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb32-1"><a href="#cb32-1" aria-hidden="true" tabindex="-1"></a><span class="co">#columns</span></span>
<span id="cb32-2"><a href="#cb32-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ncol</span>(x)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 5</code></pre>
</div>
<div class="sourceCode cell-code" id="cb34"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb34-1"><a href="#cb34-1" aria-hidden="true" tabindex="-1"></a><span class="co">#both row and columns</span></span>
<span id="cb34-2"><a href="#cb34-2" aria-hidden="true" tabindex="-1"></a><span class="fu">dim</span>(x)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 17  5</code></pre>
</div>
</div>
<blockquote class="blockquote">
<p>Q2. Which approach to solving the ‘row-names problem’ mentioned above do you prefer and why? Is one approach more robust than another under certain circumstances? #Check my data</p>
</blockquote>
<div class="cell">
<div class="sourceCode cell-code" id="cb36"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb36-1"><a href="#cb36-1" aria-hidden="true" tabindex="-1"></a><span class="fu">View</span>(x)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>#To fix the wrong number of columns we can drop column x from the dataframe</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb37"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb37-1"><a href="#cb37-1" aria-hidden="true" tabindex="-1"></a><span class="fu">rownames</span>(x) <span class="ot">&lt;-</span> x[,<span class="dv">1</span>]</span>
<span id="cb37-2"><a href="#cb37-2" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> x[,<span class="sc">-</span><span class="dv">1</span>]</span>
<span id="cb37-3"><a href="#cb37-3" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(x)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>               England Wales Scotland N.Ireland
Cheese             105   103      103        66
Carcass_meat       245   227      242       267
Other_meat         685   803      750       586
Fish               147   160      122        93
Fats_and_oils      193   235      184       209
Sugars             156   175      147       139</code></pre>
</div>
</div>
<p>#But everytime you run it, you will drop one of the column, so the better way is to read <code>row.names</code>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb39"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb39-1"><a href="#cb39-1" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(url, <span class="at">row.names=</span><span class="dv">1</span>)</span>
<span id="cb39-2"><a href="#cb39-2" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(x)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>               England Wales Scotland N.Ireland
Cheese             105   103      103        66
Carcass_meat       245   227      242       267
Other_meat         685   803      750       586
Fish               147   160      122        93
Fats_and_oils      193   235      184       209
Sugars             156   175      147       139</code></pre>
</div>
</div>
<p>##So use <code>row.names</code> during read.csv is better, because -1 will detele one column everytime you run it. Answer: x &lt;- read.csv(url, row.names=1)</p>
<blockquote class="blockquote">
<p>Q3: Changing what optional argument in the above barplot() function results in the following plot?</p>
</blockquote>
<div class="cell">
<div class="sourceCode cell-code" id="cb41"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb41-1"><a href="#cb41-1" aria-hidden="true" tabindex="-1"></a><span class="fu">barplot</span>(<span class="fu">as.matrix</span>(x), <span class="at">beside=</span>T, <span class="at">col=</span><span class="fu">rainbow</span>(<span class="fu">nrow</span>(x)))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="Class07_files/figure-html/unnamed-chunk-20-1.png" class="img-fluid" width="672"></p>
</div>
<div class="sourceCode cell-code" id="cb42"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb42-1"><a href="#cb42-1" aria-hidden="true" tabindex="-1"></a><span class="co"># To change it, simply change default the setting</span></span>
<span id="cb42-2"><a href="#cb42-2" aria-hidden="true" tabindex="-1"></a>fix_plot <span class="ot">&lt;-</span> <span class="fu">barplot</span>(<span class="fu">as.matrix</span>(x), <span class="at">beside=</span><span class="cn">FALSE</span>, <span class="at">col=</span><span class="fu">rainbow</span>(<span class="fu">nrow</span>(x)))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="Class07_files/figure-html/unnamed-chunk-20-2.png" class="img-fluid" width="672"></p>
</div>
<div class="sourceCode cell-code" id="cb43"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb43-1"><a href="#cb43-1" aria-hidden="true" tabindex="-1"></a>fix_plot</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.7 1.9 3.1 4.3</code></pre>
</div>
</div>
<blockquote class="blockquote">
<p>Q5: Generating all pairwise plots may help somewhat. Can you make sense of the following code and resulting figure? What does it mean if a given point lies on the diagonal for a given plot?</p>
</blockquote>
<div class="cell">
<div class="sourceCode cell-code" id="cb45"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb45-1"><a href="#cb45-1" aria-hidden="true" tabindex="-1"></a><span class="fu">pairs</span>(x, <span class="at">col=</span><span class="fu">rainbow</span>(<span class="dv">10</span>), <span class="at">pch=</span><span class="dv">16</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="Class07_files/figure-html/unnamed-chunk-21-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>#the axies are changed, based on the plot format, the row gives the y-axis country and the column gives x-axis country. And England and wales are pretty similar, based on the points (points are aways from each other), we can see Scotland is less similar to England and Wales. And N.Ireland is even more different from England and Wales, and also different from Scotland.</p>
<blockquote class="blockquote">
<p>Q6. What is the main differences between N. Ireland and the other countries of the UK in terms of this data-set?</p>
</blockquote>
<p>#N.Ireland is different from England, Wales, and Scotland. Based on the graph, the point is more far away from each other.</p>
<blockquote class="blockquote">
<p>Q7. Complete the code below to generate a plot of PC1 vs PC2. The second line adds text labels over the data points.</p>
</blockquote>
<p>The main PCA function in base R is called <code>prcomp()</code> it expects the transpose of our data</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb46"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb46-1"><a href="#cb46-1" aria-hidden="true" tabindex="-1"></a>pca <span class="ot">&lt;-</span> <span class="fu">prcomp</span>(<span class="fu">t</span>(x))</span>
<span id="cb46-2"><a href="#cb46-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(pca)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Importance of components:
                            PC1      PC2      PC3       PC4
Standard deviation     324.1502 212.7478 73.87622 4.189e-14
Proportion of Variance   0.6744   0.2905  0.03503 0.000e+00
Cumulative Proportion    0.6744   0.9650  1.00000 1.000e+00</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb48"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb48-1"><a href="#cb48-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot PC1 vs PC2</span></span>
<span id="cb48-2"><a href="#cb48-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(pca<span class="sc">$</span>x[,<span class="dv">1</span>], pca<span class="sc">$</span>x[,<span class="dv">2</span>], <span class="at">xlab=</span><span class="st">"PC1"</span>, <span class="at">ylab=</span><span class="st">"PC2"</span>, <span class="at">xlim=</span><span class="fu">c</span>(<span class="sc">-</span><span class="dv">270</span>,<span class="dv">500</span>))</span>
<span id="cb48-3"><a href="#cb48-3" aria-hidden="true" tabindex="-1"></a><span class="fu">text</span>(pca<span class="sc">$</span>x[,<span class="dv">1</span>], pca<span class="sc">$</span>x[,<span class="dv">2</span>], <span class="at">labels=</span><span class="fu">colnames</span>(x))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="Class07_files/figure-html/unnamed-chunk-23-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<blockquote class="blockquote">
<p>Q8. Customize your plot so that the colors of the country names match the colors in our UK and Ireland map and table at start of this document.</p>
</blockquote>
<div class="cell">
<div class="sourceCode cell-code" id="cb49"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb49-1"><a href="#cb49-1" aria-hidden="true" tabindex="-1"></a><span class="co">#change the color of the dots</span></span>
<span id="cb49-2"><a href="#cb49-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(pca<span class="sc">$</span>x[,<span class="dv">1</span>], pca<span class="sc">$</span>x[,<span class="dv">2</span>], <span class="at">xlab=</span><span class="st">"PC1"</span>, <span class="at">ylab=</span><span class="st">"PC2"</span>, <span class="at">xlim=</span><span class="fu">c</span>(<span class="sc">-</span><span class="dv">270</span>,<span class="dv">500</span>), <span class="at">col =</span> <span class="fu">c</span>(<span class="st">"orange"</span>, <span class="st">"red"</span>, <span class="st">"blue"</span>, <span class="st">"darkgreen"</span>), <span class="at">pch=</span><span class="dv">16</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="Class07_files/figure-html/unnamed-chunk-24-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb50"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb50-1"><a href="#cb50-1" aria-hidden="true" tabindex="-1"></a><span class="co">#change color of the text</span></span>
<span id="cb50-2"><a href="#cb50-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(pca<span class="sc">$</span>x[,<span class="dv">1</span>], pca<span class="sc">$</span>x[,<span class="dv">2</span>], <span class="at">xlab=</span><span class="st">"PC1"</span>, <span class="at">ylab=</span><span class="st">"PC2"</span>, <span class="at">xlim=</span><span class="fu">c</span>(<span class="sc">-</span><span class="dv">270</span>,<span class="dv">500</span>))</span>
<span id="cb50-3"><a href="#cb50-3" aria-hidden="true" tabindex="-1"></a><span class="fu">text</span>(pca<span class="sc">$</span>x[,<span class="dv">1</span>], pca<span class="sc">$</span>x[,<span class="dv">2</span>], <span class="at">labels=</span><span class="fu">colnames</span>(x), <span class="at">col =</span> <span class="fu">c</span>(<span class="st">"orange"</span>, <span class="st">"red"</span>, <span class="st">"blue"</span>, <span class="st">"darkgreen"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="Class07_files/figure-html/unnamed-chunk-25-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</section>

</main>
<!-- /main column -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    target: function(trigger) {
      return trigger.previousElementSibling;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->



</body></html>